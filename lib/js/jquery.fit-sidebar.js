(function(b){var a=b.fitSidebar=function(e,d){var f=this,g=f.config=b.extend({},a.defaults,d);g.target=b(e).addClass("fit-sidebar");g.blank=b("<div/>").addClass(a.id+"-blank").insertBefore(g.target);g.blank.css("border","solid 1px #fff");g.blank.css({"margin-top":g.target.css("margin-top"),"margin-right":g.target.css("margin-right"),"margin-bottom":g.target.css("margin-bottom"),"margin-left":g.target.css("margin-left"),"border-top-width":g.target.css("border-top-width"),"border-right-width":g.target.css("border-right-width"),"border-bottom-width":g.target.css("border-bottom-width"),"border-left-width":g.target.css("border-left-width"),"padding-top":g.target.css("padding-top"),"padding-right":g.target.css("padding-right"),"padding-bottom":g.target.css("padding-bottom"),"padding-left":g.target.css("padding-left")});g.wrapper=b(g.target).parents(g.wrapper);g._win=b(window).on("scroll",function(){f.adjustPosition()}).on("resize",function(){g.target.hasClass("for-chrome-bug");f.adjustPosition()});setTimeout(function(){f.adjustPosition()},0)};b.extend(b.fitSidebar.prototype,{adjustPosition:function(){var j=this,k=j.config;if(k._win.width()<k.responsiveWidth){k.wrapper.removeClass(k.fixedClassName);k.wrapper.addClass(k.noFixedClassName);k.target.removeClass(a.id+"-fixed");k.blank.hide();k.target.width("auto");k.direction=null;return}k.wrapper.addClass(k.fixedClassName);k.wrapper.removeClass(k.noFixedClassName);k.target.addClass(a.id+"-fixed");var i=k.blank.show().offset();var h=k._win.scrollTop();var g=k.target.outerHeight();var f=g-k._win.height();if(f<0){f=0}if(!k.direction){k.lastFixedTop=k.lastDownFixedTop=k.lastUpFixedTop=i.top-h;k.lastScrollTop=k.lastDownScrollTop=k.lastUpScrollTop=h}k.target.width(k.blank.width());k.blank.height(k.target.height());k.direction=h<k.lastScrollTop?"up":"down";var d=function(){var l=k.lastUpFixedTop+(k.lastUpScrollTop-h);if(l<0){if(l+f<0){l=-f;var c=k.wrapper.offset().top+k.wrapper.height();var m=h+g+l;if(m>c){l=(c-h)-g}}}k.target.css({top:l,bottom:"auto"});k.lastDownFixedTop=l;k.lastDownScrollTop=h};var e=function(){var c=k.lastDownFixedTop+(k.lastDownScrollTop-h);if(c>0){c=i.top-h;if(c<0){c=0}}k.target.css({top:c,bottom:"auto"});k.lastUpFixedTop=c;k.lastUpScrollTop=h};if(k.direction=="down"){d()}else{e()}k.lastFixedTop=top;k.lastScrollTop=h}});b.fn.fitSidebar=function(c){return this.each(function(){var d=b(this);d.data(a.id,new b.fitSidebar(d,c))})};b.extend(a,{defaults:{wrapper:"body",responsiveWidth:0,fixedClassName:"fit-sidebar-fixed-now",noFixedClassName:"fit-sidebar-no-fixed-now"},id:"fit-sidebar"})})(jQuery);